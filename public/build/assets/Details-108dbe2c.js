import m from"./Master-cad82771.js";import{_ as b,a as p,o,c as i,b as t,t as r,d as h,e as u,F as f,h as D}from"./app-ffd8b3a9.js";import{s as _}from"./multiselect-258fc9cc.js";import{Z as y}from"./vue-datepicker-e763a77b.js";import{E as g,a as B}from"./jspdf.plugin.autotable-48597783.js";import"./main-ae0ebc8a.js";import"./defineProperty-4d844dfb.js";const v={layout:m,props:["customerId"],components:{Multiselect:_,Datepicker:y},created(){this.fetchCustomerDetails()},data(){return{customerDetails:[],customer:[],pdfBtnSpinner:!1}},methods:{fetchCustomerDetails(){p.get(route("api.customer.fetch.details",this.customerId),{headers:{Authorization:"Bearer "+this.$page.props.auth_token}}).then(s=>{this.customer=s.data.customer,this.customerDetails=s.data.details}).catch(s=>{toastr.error(s.response.data.message)})},formatDate(s){const e={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString(void 0,e)},calculateBalance(s){let e=0;for(let a=0;a<=s;a++)e+=this.customerDetails[a].credit,e-=this.customerDetails[a].debit;return this.formatCurrency(e)},formatCurrency(s){return new Intl.NumberFormat("en-PK",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s)},downloadPDF(){this.pdfBtnSpinner=!0;const s=new g;s.setFontSize(18),s.setTextColor(40),s.text(`${this.customer.name} Ledger Details`,14,20),B(s,{startY:30,head:[["#","Date","Type","Credit","Debit","Balance"]],body:this.customerDetails.map((e,a)=>[a+1,this.formatDate(e.date),e.type,e.credit,e.debit,this.calculateBalance(a)]),styles:{fontSize:10,halign:"center"},headStyles:{fillColor:[0,0,0],textColor:[255,255,255]}}),s.save(`${this.customer.name}_Ledger.pdf`),this.pdfBtnSpinner=!1}}},C={id:"main",class:"main"},k={class:"pagetitle d-flex justify-content-between"},F={class:"theme-text-color"},S=["href"],x={class:"section"},w={class:"card"},P={class:"card-body c-form-card"},T={class:"d-flex justify-content-end mb-1"},L={key:1,class:"btn btn-success",type:"button",disabled:""},N={class:"table-responsive"},z={class:"table table-striped"};function I(s,e,a,V,c,n){return o(),i("main",C,[t("div",k,[t("div",null,[t("h1",F,r(c.customer.name),1),e[1]||(e[1]=h('<nav><ol class="breadcrumb"><li class="breadcrumb-item"><a href="/">Alsmi</a></li><li class="breadcrumb-item">Customer</li><li class="breadcrumb-item active">Details</li></ol></nav>',1))]),t("div",null,[t("a",{href:s.route("customers"),class:"btn btn-success mt-3"},e[2]||(e[2]=[t("i",{class:"bi bi-back"},null,-1),u(" Customers ")]),8,S)])]),t("section",x,[t("div",w,[t("div",P,[t("div",T,[c.pdfBtnSpinner?(o(),i("button",L,e[4]||(e[4]=[t("span",{class:"spinner-border spinner-border-sm"},null,-1)]))):(o(),i("button",{key:0,onClick:e[0]||(e[0]=(...l)=>n.downloadPDF&&n.downloadPDF(...l)),class:"btn btn-success mt-3 ml-3"},e[3]||(e[3]=[t("i",{class:"bi bi-file-earmark-pdf"},null,-1),u(" Download PDF ")])))]),t("div",N,[t("table",z,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Date"),t("th",null,"Type"),t("th",null,"Credit"),t("th",null,"Debit"),t("th",null,"Balance")])],-1)),t("tbody",null,[(o(!0),i(f,null,D(c.customerDetails,(l,d)=>(o(),i("tr",{key:l.id},[t("td",null,r(d+1),1),t("td",null,r(n.formatDate(l.date)),1),t("td",null,r(l.type),1),t("td",null,r(l.credit),1),t("td",null,r(l.debit),1),t("td",null,r(n.calculateBalance(d)),1)]))),128))])])])])])])])}const q=b(v,[["render",I]]);export{q as default};
