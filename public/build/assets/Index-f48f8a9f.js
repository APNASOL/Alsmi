import{_ as g,a as m,r as D,o as n,c as i,d as x,b as t,t as c,f as u,g as h,w as f,v as y,F as v,h as _}from"./app-9b4504be.js";import F from"./Master-8e66192d.js";import{s as E}from"./multiselect-33f2a26f.js";import"./jspdf.plugin.autotable-078c30b0.js";import{Z as C}from"./vue-datepicker-38d66eb2.js";import"./main-ae0ebc8a.js";import"./defineProperty-4d844dfb.js";const L={layout:F,components:{Multiselect:E,Datepicker:C},data(){return{transactionEntries:[],selectedFilter:"Yearly",selectedMonth:1,selectedYear:2025,startDate:"",endDate:"",monthsOptions:[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],yearsOptions:Array.from({length:2050-2025+1},(a,e)=>2025+e),totalIncome:0,totalExpense:0,totalBalance:0,existing_receipt_image:"",FilterErrors:"",serachingLoading:!1,pdfBtnLoader:!1,excelBtnLoader:!1,printBtnLoader:!1}},mounted(){this.fetchTransactionEntries()},methods:{fetchTransactionEntries(){if(this.serachingLoading=!0,this.FilterErrors="",this.selectedFilter==="Monthly"&&(!this.selectedMonth||!this.selectedYear)){this.FilterErrors="Please select both Month and Year for the Monthly filter.",this.serachingLoading=!1;return}if(this.selectedFilter==="Yearly"&&!this.selectedYear){this.FilterErrors="Please select a Year for the Yearly filter.",this.serachingLoading=!1;return}if(this.selectedFilter==="Custom"&&(!this.startDate||!this.endDate)){this.FilterErrors="Please select both Start Date and End Date for the Custom filter.",this.serachingLoading=!1;return}let a=new FormData;a.append("selectedFilter",this.selectedFilter),this.selectedMonth&&a.append("selectedMonth",this.selectedMonth),this.selectedYear&&a.append("selectedYear",this.selectedYear),this.startDate&&a.append("startDate",this.startDate),this.endDate&&a.append("endDate",this.endDate),m.post(route("api.transaction.report.fetch"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.serachingLoading=!1,this.transactionEntries=e.data.transactionEntries,this.totalIncome=e.data.totalIncome,this.totalExpense=e.data.totalExpense,this.totalBalance=e.data.totalBalance}).catch(e=>{this.serachingLoading=!1,console.error(e)})},printSlip(){let a=window.open("","_blank"),e="All Transactions List";this.selectedFilter==="Monthly"&&this.selectedMonth?e=`Transactions for ${this.monthsOptions.find(d=>d.value===this.selectedMonth).label} ${this.selectedYear}`:this.selectedFilter==="Yearly"&&this.selectedYear?e=`Transactions for the Year ${this.selectedYear}`:this.selectedFilter==="Custom"&&this.startDate&&this.endDate&&(e=`Transactions from ${this.formatDate(this.startDate)} to ${this.formatDate(this.endDate)}`),a.document.write(`
                <html>
                <head>
                    <title>Transaction Slip</title>
                    <style>
                        body { font-family: Arial, sans-serif; }
                        h2 { text-align: center; margin-bottom: 20px; }
                        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        th, td { border: 1px solid black; padding: 8px; text-align: left; }
                        th { background-color: #f2f2f2; }
                        .footer { text-align: right; font-size: 12px; margin-top: 20px; }
                    </style>
                </head>
                <body>
                    <h2>${e}</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Date</th>
                                <th>Income</th>
                                <th>Expense</th>
                                <th>Balance</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${this.transactionEntries.map((r,d)=>`
                                <tr>
                                    <td>${d+1}</td>
                                    <td>${r.date}</td>
                                    <td>${this.formatCurrency(r.income)}</td>
                                    <td>${this.formatCurrency(r.expense)}</td>
                                    <td>${this.formatCurrency(r.balance)}</td>
                                </tr>
                            `).join("")}
                        </tbody>
                    </table>
                    <div class="footer">Printed: ${new Date().toLocaleString("en-US",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}</div>
                </body>
                </html>
            `),a.document.close(),a.onload=function(){a.print(),a.close()}},exportToExcel(){this.excelBtnLoader=!0;let a=new FormData;a.append("selectedFilter",this.selectedFilter),this.selectedMonth&&a.append("selectedMonth",this.selectedMonth),this.selectedYear&&a.append("selectedYear",this.selectedYear),this.startDate&&a.append("startDate",this.startDate),this.endDate&&a.append("endDate",this.endDate),m.post(route("download-report-excel"),a,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{const r=document.createElement("a"),d=window.URL.createObjectURL(new Blob([e.data]));r.href=d,r.setAttribute("download","TransactionReport.xlsx"),document.body.appendChild(r),r.click(),document.body.removeChild(r),this.excelBtnLoader=!1}).catch(e=>{var r,d;this.excelBtnLoader=!1,toastr.error(((d=(r=e.response)==null?void 0:r.data)==null?void 0:d.message)||"Error generating Excel")})},exportToPDF(){this.pdfBtnLoader=!0;let a=new FormData;a.append("selectedFilter",this.selectedFilter),this.selectedMonth&&a.append("selectedMonth",this.selectedMonth),this.selectedYear&&a.append("selectedYear",this.selectedYear),this.startDate&&a.append("startDate",this.startDate),this.endDate&&a.append("endDate",this.endDate),m.post(route("download-report-pdf"),a,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{const r=document.createElement("a"),d=window.URL.createObjectURL(new Blob([e.data]));r.href=d,r.setAttribute("download","TransactionReport.pdf"),document.body.appendChild(r),r.click(),document.body.removeChild(r),this.pdfBtnLoader=!1}).catch(e=>{var r,d;this.pdfBtnLoader=!1,toastr.error(((d=(r=e.response)==null?void 0:r.data)==null?void 0:d.message)||"Error generating PDF")})},formatCurrency(a){return new Intl.NumberFormat("en-PK",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a)},formatDate(a){return new Date(a).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric"})}}},Y={id:"main",class:"main"},k={class:"section"},M={class:"card"},w={class:"card-body"},T={class:"card-title theme-text-color"},B={class:"card card-body p-2"},V={class:"d-flex justify-content-between align-items-center c-filter"},S={class:"d-flex align-items-center gap-2"},U={class:"col-auto"},I={key:0,class:"col-auto d-flex gap-2"},P={class:"col-auto"},A={class:"col-auto"},N={key:1,class:"col-auto"},O={key:2,class:"col-auto d-flex gap-2"},R={class:"col-auto"},j=["disabled"],J={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Z={key:1},z={key:0,class:"btn-group",role:"group"},K=["disabled"],W={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},q={key:1},G=["disabled"],H={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Q={key:1},X={key:0,class:"text-danger"},$={key:0,class:"table-responsive"},ee={class:"table table-striped"},te={scope:"col"},se={scope:"row"},ae={key:1};function re(a,e,r,d,s,o){const p=D("Multiselect");return n(),i("main",Y,[e[19]||(e[19]=x('<div class="pagetitle d-flex justify-content-between" data-v-109b9235><div data-v-109b9235><h1 class="theme-text-color" data-v-109b9235>Reports</h1><nav data-v-109b9235><ol class="breadcrumb" data-v-109b9235><li class="breadcrumb-item" data-v-109b9235><a href="/dashboard" data-v-109b9235>Alsmi</a></li><li class="breadcrumb-item" data-v-109b9235>Reports</li><li class="breadcrumb-item active" data-v-109b9235>Index</li></ol></nav></div></div>',1)),t("section",k,[t("div",M,[t("div",w,[t("h5",T," All Transaction & Reports "+c(s.selectedFilter),1),t("div",B,[t("div",V,[t("div",S,[t("div",U,[u(p,{modelValue:s.selectedFilter,"onUpdate:modelValue":e[0]||(e[0]=l=>s.selectedFilter=l),options:["Monthly","Yearly","Custom"],searchable:!0,placeholder:"Filter By"},null,8,["modelValue"])]),s.selectedFilter==="Monthly"?(n(),i("div",I,[t("div",P,[u(p,{modelValue:s.selectedYear,"onUpdate:modelValue":e[1]||(e[1]=l=>s.selectedYear=l),options:s.yearsOptions,searchable:!0,onClear:o.fetchTransactionEntries,placeholder:"Select Year"},null,8,["modelValue","options","onClear"])]),t("div",A,[u(p,{modelValue:s.selectedMonth,"onUpdate:modelValue":e[2]||(e[2]=l=>s.selectedMonth=l),options:s.monthsOptions,searchable:!0,onClear:o.fetchTransactionEntries,placeholder:"Select Month"},null,8,["modelValue","options","onClear"])])])):h("",!0),s.selectedFilter==="Yearly"?(n(),i("div",N,[u(p,{modelValue:s.selectedYear,"onUpdate:modelValue":e[3]||(e[3]=l=>s.selectedYear=l),options:s.yearsOptions,searchable:!0,onClear:o.fetchTransactionEntries,placeholder:"Select Year"},null,8,["modelValue","options","onClear"])])):h("",!0),s.selectedFilter==="Custom"?(n(),i("div",O,[f(t("input",{type:"date",class:"form-control",id:"date","onUpdate:modelValue":e[4]||(e[4]=l=>s.startDate=l),placeholder:"Start Date"},null,512),[[y,s.startDate]]),f(t("input",{type:"date",class:"form-control",id:"date","onUpdate:modelValue":e[5]||(e[5]=l=>s.endDate=l),placeholder:"End Date"},null,512),[[y,s.endDate]])])):h("",!0),t("div",R,[t("button",{onClick:e[6]||(e[6]=(...l)=>o.fetchTransactionEntries&&o.fetchTransactionEntries(...l)),class:"btn btn-success",disabled:s.serachingLoading},[s.serachingLoading?(n(),i("span",J)):h("",!0),s.serachingLoading?h("",!0):(n(),i("span",Z,"Search"))],8,j)])]),s.transactionEntries&&s.transactionEntries.length?(n(),i("div",z,[t("button",{class:"btn btn-primary",title:"Download as Excel",onClick:e[7]||(e[7]=(...l)=>o.exportToExcel&&o.exportToExcel(...l)),disabled:s.excelBtnLoader},[s.excelBtnLoader?(n(),i("span",W)):h("",!0),s.excelBtnLoader?h("",!0):(n(),i("span",q,e[10]||(e[10]=[t("i",{class:"bi bi-file-earmark-excel"},null,-1)])))],8,K),t("button",{class:"btn btn-danger",title:"Download as PDF",onClick:e[8]||(e[8]=(...l)=>o.exportToPDF&&o.exportToPDF(...l)),disabled:s.pdfBtnLoader},[s.pdfBtnLoader?(n(),i("span",H)):h("",!0),s.pdfBtnLoader?h("",!0):(n(),i("span",Q,e[11]||(e[11]=[t("i",{class:"bi bi-file-earmark-pdf"},null,-1)])))],8,G),t("button",{class:"btn btn-secondary",title:"Print",onClick:e[9]||(e[9]=(...l)=>o.printSlip&&o.printSlip(...l))},e[12]||(e[12]=[t("i",{class:"bi bi-printer"},null,-1)]))])):h("",!0)]),s.FilterErrors?(n(),i("span",X,c(s.FilterErrors),1)):h("",!0)]),s.transactionEntries.length?(n(),i("div",$,[t("table",ee,[t("thead",null,[t("tr",null,[e[13]||(e[13]=t("th",{scope:"col"},"#",-1)),t("th",te,c(s.selectedFilter==="Yearly"?"Month":"Date"),1),e[14]||(e[14]=t("th",{scope:"col"},"Income",-1)),e[15]||(e[15]=t("th",{scope:"col"},"Expense",-1)),e[16]||(e[16]=t("th",{scope:"col"},"Balance",-1))])]),t("tbody",null,[(n(!0),i(v,null,_(s.transactionEntries,(l,b)=>(n(),i("tr",{key:b},[t("th",se,c(b+1),1),t("td",null,c(l.date),1),t("td",null,c(o.formatCurrency(l.income||0)),1),t("td",null,c(o.formatCurrency(l.expense||0)),1),t("td",null,c(o.formatCurrency(l.balance||0)),1)]))),128))]),t("tfoot",null,[t("tr",null,[e[17]||(e[17]=t("th",{colspan:"2"},"Total",-1)),t("th",null,c(o.formatCurrency(s.totalIncome||0)),1),t("th",null,c(o.formatCurrency(s.totalExpense||0)),1),t("th",null,c(o.formatCurrency(s.totalBalance||0)),1)])])])])):(n(),i("div",ae,e[18]||(e[18]=[t("p",{class:"text-center text-danger"}," No data available. ",-1)])))])])])])}const pe=g(L,[["render",re],["__scopeId","data-v-109b9235"]]);export{pe as default};
