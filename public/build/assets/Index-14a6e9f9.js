import{_ as v,a as m,r as _,o as r,c as o,d as y,b as s,f as u,g as d,w as f,v as b,t as p,n as g}from"./app-9b4504be.js";import D from"./Master-8e66192d.js";import{s as F}from"./multiselect-33f2a26f.js";import"./jspdf.plugin.autotable-078c30b0.js";import{Z as E}from"./vue-datepicker-38d66eb2.js";import"./main-ae0ebc8a.js";import"./defineProperty-4d844dfb.js";const x={layout:D,components:{Multiselect:F,Datepicker:E},data(){return{filteredEntries:[],selectedFilter:"Monthly",selectedMonth:1,selectedYear:new Date().getFullYear(),startDate:"",endDate:"",monthsOptions:[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],yearsOptions:Array.from({length:2050-2025+1},(a,e)=>2025+e),transactionEntries:[],totalIncome:0,totalExpense:0,totalProfit:0,FilterErrors:"",serachingLoading:!1,pdfBtnLoader:!1,excelBtnLoader:!1}},mounted(){this.fetchTransactionEntries()},methods:{fetchTransactionEntries(){if(this.serachingLoading=!0,this.FilterErrors="",this.selectedFilter==="Monthly"&&(!this.selectedMonth||!this.selectedYear)){this.FilterErrors="Please select both Month and Year for the Monthly filter.",this.serachingLoading=!1;return}if(this.selectedFilter==="Yearly"&&!this.selectedYear){this.FilterErrors="Please select a Year for the Yearly filter.",this.serachingLoading=!1;return}if(this.selectedFilter==="Custom"&&(!this.startDate||!this.endDate)){this.FilterErrors="Please select both Start Date and End Date for the Custom filter.",this.serachingLoading=!1;return}let a=new FormData;a.append("selectedFilter",this.selectedFilter),this.selectedMonth&&a.append("selectedMonth",this.selectedMonth),this.selectedYear&&a.append("selectedYear",this.selectedYear),this.startDate&&a.append("startDate",this.startDate),this.endDate&&a.append("endDate",this.endDate),m.post(route("api.transaction.income.statements.fetch"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.serachingLoading=!1,console.log(e.data),this.transactionEntries=e.data.transactionEntries||[],this.totalIncome=e.data.totalIncome||0,this.totalExpense=e.data.totalExpense||0,this.totalProfit=e.data.totalProfit||0}).catch(e=>{this.serachingLoading=!1,console.error(e)})},applyFilter(){let a=[...this.transactionEntries];this.selectedFilter==="Monthly"?a=a.filter(e=>new Date(e.transaction_date).getMonth()+1===this.selectedMonth&&new Date(e.transaction_date).getFullYear()===this.selectedYear):this.selectedFilter==="Yearly"?a=a.filter(e=>new Date(e.transaction_date).getFullYear()===this.selectedYear):this.selectedFilter==="Custom"&&(a=a.filter(e=>new Date(e.transaction_date)>=new Date(this.startDate)&&new Date(e.transaction_date)<=new Date(this.endDate))),this.filteredEntries=a,this.calculateSummary()},calculateSummary(){this.totalIncome=this.filteredEntries.reduce((a,e)=>a+parseFloat(e.cash_in||0),0),this.totalExpense=this.filteredEntries.reduce((a,e)=>a+parseFloat(e.cash_out||0),0),this.totalProfit=this.totalIncome-this.totalExpense},formatCurrency(a){return new Intl.NumberFormat("en-PK",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a)},exportToPDF(){this.pdfBtnLoader=!0;let a=new FormData;a.append("selectedFilter",this.selectedFilter),this.selectedMonth&&a.append("selectedMonth",this.selectedMonth),this.selectedYear&&a.append("selectedYear",this.selectedYear),this.startDate&&a.append("startDate",this.startDate),this.endDate&&a.append("endDate",this.endDate),m.post(route("download-income-statement-pdf"),a,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then(e=>{const i=document.createElement("a"),c=window.URL.createObjectURL(new Blob([e.data]));i.href=c,i.setAttribute("download","TransactionReport.pdf"),document.body.appendChild(i),i.click(),document.body.removeChild(i),this.pdfBtnLoader=!1}).catch(e=>{var i,c;this.pdfBtnLoader=!1,toastr.error(((c=(i=e.response)==null?void 0:i.data)==null?void 0:c.message)||"Error generating PDF")})}}},M={id:"main",class:"main"},Y={class:"section"},C={class:"card"},w={class:"card-body"},L={class:"card card-body p-2"},k={class:"d-flex justify-content-between align-items-center c-filter"},V={class:"d-flex align-items-center gap-2"},P={class:"col-auto"},T={key:0,class:"col-auto d-flex gap-2"},I={class:"col-auto"},S={class:"col-auto"},B={key:1,class:"col-auto"},U={key:2,class:"col-auto d-flex gap-2"},N={class:"col-auto"},O=["disabled"],A={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},j={key:1},J={key:0,class:"btn-group",role:"group"},R=["disabled"],Z={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},z={key:1},K={key:0,class:"text-danger"},q={key:0},G={class:"table table-bordered"},H={colspan:"1",class:"text-success"},Q={colspan:"1",class:"text-danger"},W={key:1};function X(a,e,i,c,t,n){const h=_("Multiselect");return r(),o("main",M,[e[15]||(e[15]=y('<div class="pagetitle d-flex justify-content-between" data-v-a1739490><div data-v-a1739490><h1 class="theme-text-color" data-v-a1739490>Income Statement</h1><nav data-v-a1739490><ol class="breadcrumb" data-v-a1739490><li class="breadcrumb-item" data-v-a1739490><a href="/dashboard" data-v-a1739490>Alsmi</a></li><li class="breadcrumb-item" data-v-a1739490>Income Statement</li><li class="breadcrumb-item active" data-v-a1739490>Index</li></ol></nav></div></div>',1)),s("section",Y,[s("div",C,[s("div",w,[e[14]||(e[14]=s("h5",{class:"card-title theme-text-color"}," Income Statement ",-1)),s("div",L,[s("div",k,[s("div",V,[s("div",P,[u(h,{modelValue:t.selectedFilter,"onUpdate:modelValue":e[0]||(e[0]=l=>t.selectedFilter=l),options:["Monthly","Yearly","Custom"],searchable:!0,placeholder:"Filter By"},null,8,["modelValue"])]),t.selectedFilter==="Monthly"?(r(),o("div",T,[s("div",I,[u(h,{modelValue:t.selectedYear,"onUpdate:modelValue":e[1]||(e[1]=l=>t.selectedYear=l),options:t.yearsOptions,searchable:!0,onClear:n.fetchTransactionEntries,placeholder:"Select Year"},null,8,["modelValue","options","onClear"])]),s("div",S,[u(h,{modelValue:t.selectedMonth,"onUpdate:modelValue":e[2]||(e[2]=l=>t.selectedMonth=l),options:t.monthsOptions,searchable:!0,onClear:n.fetchTransactionEntries,placeholder:"Select Month"},null,8,["modelValue","options","onClear"])])])):d("",!0),t.selectedFilter==="Yearly"?(r(),o("div",B,[u(h,{modelValue:t.selectedYear,"onUpdate:modelValue":e[3]||(e[3]=l=>t.selectedYear=l),options:t.yearsOptions,searchable:!0,onClear:n.fetchTransactionEntries,placeholder:"Select Year"},null,8,["modelValue","options","onClear"])])):d("",!0),t.selectedFilter==="Custom"?(r(),o("div",U,[f(s("input",{type:"date",class:"form-control",id:"date","onUpdate:modelValue":e[4]||(e[4]=l=>t.startDate=l),placeholder:"Start Date"},null,512),[[b,t.startDate]]),f(s("input",{type:"date",class:"form-control",id:"date","onUpdate:modelValue":e[5]||(e[5]=l=>t.endDate=l),placeholder:"End Date"},null,512),[[b,t.endDate]])])):d("",!0),s("div",N,[s("button",{onClick:e[6]||(e[6]=(...l)=>n.fetchTransactionEntries&&n.fetchTransactionEntries(...l)),class:"btn btn-success",disabled:t.serachingLoading},[t.serachingLoading?(r(),o("span",A)):d("",!0),t.serachingLoading?d("",!0):(r(),o("span",j,"Search"))],8,O)])]),t.transactionEntries&&t.transactionEntries.length?(r(),o("div",J,[s("button",{class:"btn btn-danger",title:"Download as PDF",onClick:e[7]||(e[7]=(...l)=>n.exportToPDF&&n.exportToPDF(...l)),disabled:t.pdfBtnLoader},[t.pdfBtnLoader?(r(),o("span",Z)):d("",!0),t.pdfBtnLoader?d("",!0):(r(),o("span",z,e[8]||(e[8]=[s("i",{class:"bi bi-file-earmark-pdf"},null,-1)])))],8,R)])):d("",!0)]),t.FilterErrors?(r(),o("span",K,p(t.FilterErrors),1)):d("",!0)]),t.transactionEntries.length?(r(),o("div",q,[s("table",G,[s("thead",null,[e[12]||(e[12]=s("tr",null,[s("th",{colspan:"2"},"Title"),s("th",{colspan:"1"},"Amount")],-1)),s("tr",null,[e[9]||(e[9]=s("th",{colspan:"2"},"Income",-1)),s("td",H,p(n.formatCurrency(t.totalIncome)),1)]),s("tr",null,[e[10]||(e[10]=s("th",{colspan:"2"},"Expense",-1)),s("td",Q,p(n.formatCurrency(t.totalExpense)),1)]),s("tr",null,[e[11]||(e[11]=s("th",{colspan:"2"},"Profit",-1)),s("th",{colspan:"1",class:g(t.totalProfit>=0?"text-success":"text-danger")},p(n.formatCurrency(t.totalProfit)),3)])])])])):(r(),o("div",W,e[13]||(e[13]=[s("p",{class:"text-center text-danger"}," No data available. ",-1)])))])])])])}const oe=v(x,[["render",X],["__scopeId","data-v-a1739490"]]);export{oe as default};
